---
title: "LVEDA.Rmd"
output: html_document
date: "2023-07-28"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(scipen = 0, digits = 3)  # controls base R output
# check if you have ISLR package, if not, install it
if(!require('pacman')) {install.packages('pacman')}
pacman::p_load(ISLR, readxl, tidyverse, magrittr, dplyr, ggplot2, ggrepel, data.table, lubridate, ggpubr, patchwork)
```


```{r}
# coordinates are 36.17, -115.14

chicago_full <- fread("data/Chicago_Solar_Irradiation/chicago.csv")

head(chicago_full)
str(chicago_full)

chicago_full$Date <- make_datetime(year=chicago_full$Year, month=chicago_full$Month, day=chicago_full$Day, hour=chicago_full$Hour, min=chicago_full$Minute)
chicago_full %>% ggplot(aes(x=Date, y=Temperature)) + geom_line(color="blue") 

plots <- NULL

# create a graph for each of the 20 years
temp <- chicago_full %>% 
  # average by year-month
  group_by(Year, Month) %>% 
  summarise(Temperature = mean(Temperature, na.rm = TRUE), .groups = "drop") %>% 
  ggplot() +
  geom_line(aes(x = Month, y = Temperature, color = factor(Year))) +
  scale_x_continuous(breaks = 1:12, labels = month.abb, minor_breaks = NULL) +
  labs(title = "Average Temperature by Month", colour = "Year")

dew <- chicago_full %>% 
  # average by year-month
  group_by(Year, Month) %>% 
  summarise(`Dew Point` = mean(`Dew Point`, na.rm = TRUE), .groups = "drop") %>% 
  ggplot() +
  geom_line(aes(x = Month, y = `Dew Point`, color = factor(Year))) +
  scale_x_continuous(breaks = 1:12, labels = month.abb, minor_breaks = NULL) +
  labs(title = "Average Dew Point by Month", colour = "Year")

humidity <- chicago_full %>% 
  # average by year-month
  group_by(Year, Month) %>% 
  summarise(`Relative Humidity` = mean(`Relative Humidity`, na.rm = TRUE), .groups = "drop") %>% 
  ggplot() +
  geom_line(aes(x = Month, y = `Relative Humidity`, color = factor(Year))) +
  scale_x_continuous(breaks = 1:12, labels = month.abb, minor_breaks = NULL) +
  labs(title = "Average Relative Humidity by Month", colour = "Year")

albedo <- chicago_full %>% 
  # average by year-month
  group_by(Year, Month) %>% 
  summarise(`Surface Albedo` = mean(`Surface Albedo`, na.rm = TRUE), .groups = "drop") %>% 
  ggplot() +
  geom_line(aes(x = Month, y = `Surface Albedo`, color = factor(Year))) +
  scale_x_continuous(breaks = 1:12, labels = month.abb, minor_breaks = NULL) +
  labs(title = "Average Surface Albedo by Month", colour = "Year")

wind <- chicago_full %>% 
  # average by year-month
  group_by(Year, Month) %>% 
  summarise(`Wind Speed` = mean(`Wind Speed`, na.rm = TRUE), .groups = "drop") %>% 
  ggplot() +
  geom_line(aes(x = Month, y = `Wind Speed`, color = factor(Year))) +
  scale_x_continuous(breaks = 1:12, labels = month.abb, minor_breaks = NULL) +
  labs(title = "Average Wind Speed by Month", colour = "Year")

pressure <- chicago_full %>% 
  # average by year-month
  group_by(Year, Month) %>% 
  summarise(`Pressure` = mean(`Pressure`, na.rm = TRUE), .groups = "drop") %>% 
  ggplot() +
  geom_line(aes(x = Month, y = `Pressure`, color = factor(Year))) +
  scale_x_continuous(breaks = 1:12, labels = month.abb, minor_breaks = NULL) +
  labs(title = "Average Pressure by Month", colour = "Year")

windD <- chicago_full %>% 
  # average by year-month
  group_by(Year, Month) %>% 
  summarise(`Wind Direction` = mean(`Wind Direction`, na.rm = TRUE), .groups = "drop") %>% 
  ggplot() +
  geom_line(aes(x = Month, y = `Wind Direction`, color = factor(Year))) +
  scale_x_continuous(breaks = 1:12, labels = month.abb, minor_breaks = NULL) +
  labs(title = "Average Wind Direction by Month", colour = "Year")

precip <- chicago_full %>% 
  # average by year-month
  group_by(Year, Month) %>% 
  summarise(`Precipitable Water` = mean(`Precipitable Water`, na.rm = TRUE), .groups = "drop") %>% 
  ggplot() +
  geom_line(aes(x = Month, y = `Precipitable Water`, color = factor(Year))) +
  scale_x_continuous(breaks = 1:12, labels = month.abb, minor_breaks = NULL) +
  labs(title = "Average Precipitable Water by Month", colour = "Year")

zenith <- chicago_full %>% ggplot(aes(x=`Solar Zenith Angle`)) + geom_histogram(bins=360) + scale_x_continuous(breaks=seq(0,360,30)) + labs(title="Solar Zenith Angle Histogram")

ghi <- chicago_full %>% 
  # average by year-month
  group_by(Year, Month) %>% 
  summarise(`GHI` = mean(`GHI`, na.rm = TRUE), .groups = "drop") %>% 
  ggplot() +
  geom_line(aes(x = Month, y = `GHI`, color = factor(Year))) +
  scale_x_continuous(breaks = 1:12, labels = month.abb, minor_breaks = NULL) +
  labs(title = "Average GHI by Month", colour = "Year")

cloud <- chicago_full %>% ggplot(aes(x=`Cloud Type`)) + geom_histogram(bins=11) + scale_x_continuous(breaks=seq(0,10,1))+ labs(title="Cloud Type")

vsTemp <- chicago_full %>% 
  group_by(Year, Month) %>% 
  summarise(`GHI` = mean(`GHI`, na.rm=TRUE), `Temperature` = mean(`Temperature`, na.rm=TRUE)) %>% 
  ggplot(aes(x=`Temperature`, y=GHI)) + geom_point()

vsDew <- chicago_full %>% 
  group_by(Year, Month) %>% 
  summarise(`GHI` = mean(`GHI`, na.rm=TRUE), `Dew Point` = mean(`Dew Point`, na.rm=TRUE)) %>% 
  ggplot(aes(x=`Dew Point`, y=GHI)) + geom_point()

vsHumid <- chicago_full %>% 
  group_by(Year, Month) %>% 
  summarise(`GHI` = mean(`GHI`, na.rm=TRUE), `Relative Humidity` = mean(`Relative Humidity`, na.rm=TRUE)) %>% 
  ggplot(aes(x=`Relative Humidity`, y=GHI)) + geom_point()

vsAlbedo <- chicago_full %>% 
  group_by(Year, Month) %>% 
  summarise(`GHI` = mean(`GHI`, na.rm=TRUE), `Surface Albedo` = mean(`Surface Albedo`, na.rm=TRUE)) %>% 
  ggplot(aes(x=`Surface Albedo`, y=GHI)) + geom_point()

vsWindS <- chicago_full %>% 
  group_by(Year, Month) %>% 
  summarise(`GHI` = mean(`GHI`, na.rm=TRUE), `Wind Speed` = mean(`Wind Speed`, na.rm=TRUE)) %>% 
  ggplot(aes(x=`Wind Speed`, y=GHI)) + geom_point()

vsPressure <- chicago_full %>% 
  group_by(Year, Month) %>% 
  summarise(`GHI` = mean(`GHI`, na.rm=TRUE), `Pressure` = mean(`Pressure`, na.rm=TRUE)) %>% 
  ggplot(aes(x=`Pressure`, y=GHI)) + geom_point()

vsWindD <- chicago_full %>% 
  group_by(Year, Month) %>% 
  summarise(`GHI` = mean(`GHI`, na.rm=TRUE), `Wind Direction` = mean(`Wind Direction`, na.rm=TRUE)) %>% 
  ggplot(aes(x=`Wind Direction`, y=GHI)) + geom_point()

vsPrecip <- chicago_full %>% 
  group_by(Year, Month) %>% 
  summarise(`GHI` = mean(`GHI`, na.rm=TRUE), `Precipitable Water` = mean(`Precipitable Water`, na.rm=TRUE)) %>% 
  ggplot(aes(x=`Precipitable Water`, y=GHI)) + geom_point()

vsWindD <- chicago_full %>% 
  group_by(Year, Month) %>% 
  summarise(`GHI` = mean(`GHI`, na.rm=TRUE), `Wind Direction` = mean(`Wind Direction`, na.rm=TRUE)) %>% 
  ggplot(aes(x=`Wind Direction`, y=GHI)) + geom_point()

vsZenith <- chicago_full %>%
  group_by(`Solar Zenith Angle`) %>%
  summarise(average_ghi = mean(GHI, na.rm=TRUE)) %>%
  ggplot(aes(x=`Solar Zenith Angle`, y=average_ghi)) + geom_point()

vsCloud <- chicago_full %>%
  group_by(`Cloud Type`) %>%
  summarise(average_ghi = mean(GHI, na.rm=TRUE)) %>%
  ggplot(aes(x=`Cloud Type`, y=average_ghi)) + geom_point()

plots <- list(temp, dew, humidity, albedo, wind, pressure, windD, precip, zenith, ghi, cloud)
plots
plotsVs <- list(vsTemp, vsDew, vsHumid, vsAlbedo, vsWindS, vsPressure, vsWindD, vsPrecip, vsZenith, vsCloud)
plotsVs

summary(chicago_full)
```